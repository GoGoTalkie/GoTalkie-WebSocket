# GoTalkie WebSocket Chat - (After Refactor)

---

## 🚀 How to Run the Project

### First Time Setup

**Step 1: Install Dependencies**

```powershell
# Install Go dependencies
go mod download

# Install React dependencies
cd client
npm install
cd ..
```
--- 

## Running the Project

### Quick Run Script (Easiest Way!)

```powershell
.\run.ps1
```

Choose:
- **1** = Development Mode (Recommended for Coding)
- **2** = Production Mode 

Run it manually **2 options** :

#### Option 1: Development Mode 

This mode gives you **hot reload** - your changes appear instantly without rebuilding!

**Open 2 Terminals:**

**Terminal 1 - Backend Server:**
```powershell
go build -o .\bin\server.exe .\cmd\server\main.go
.\bin\server.exe
```

**Terminal 2 - Frontend Dev Server:**
```powershell
cd client
npm run dev
```

**Open your browser:**
- Go to: `http://localhost:3000`
- Edit files in `client/src/` → Save → See changes instantly! ⚡

#### Option 2: Production Mode (For Deployment)

This builds optimized files for production use.

```powershell
# Build React frontend
cd client
npm run build
cd ..

# Build Go backend
go build -o .\bin\server.exe .\cmd\server\main.go

# Run server
.\bin\server.exe
```
---

## 🔄 What Changed After Refactoring

### Major Changes

| Before | After | Reason |
|--------|-------|--------|
| **HTML/CSS/JavaScript** | **React + TypeScript** | Better code organization, type safety |
| No build process | Vite build system | Fast development, optimized production |
| Manual DOM updates | React components | Automatic UI updates |
| Global variables | React state + hooks | Better state management |
| Multiple JS files | Component-based | Easier to maintain |

### File Structure Changes

**Before (Old):**
```
static/
├── index.html              ← Single HTML file
├── script.js               ← All JavaScript mixed together
├── style.css               ← All CSS in one file
└── js/
    ├── websocket.js
    ├── chat.js
    ├── ui.js
    └── main.js
```

**After (New):**
```
client/                     ← New React app folder
├── src/
│   ├── components/         ← Separate component files
│   │   ├── Login.tsx       ← Login screen
│   │   ├── Sidebar.tsx     ← User/group list
│   │   ├── ChatArea.tsx    ← Chat messages
│   │   ├── Notification.tsx ← Toast notifications
│   │   └── CreateGroupModal.tsx ← Create group dialog
│   ├── services/
│   │   └── websocket.ts    ← WebSocket logic (class-based)
│   ├── App.tsx             ← Main app component
│   ├── App.css             ← Styles
│   ├── main.tsx            ← Entry point
│   └── types.ts            ← TypeScript types
├── package.json            ← Dependencies
├── tsconfig.json           ← TypeScript config
└── vite.config.ts          ← Build config
```

### Backend Changes

**Minimal changes to Go backend:**

**File:** `cmd/server/main.go`

```go
// Before:
app.Static("/", "./static")

// After:
app.Static("/", "./client/dist", fiber.Static{...})
app.Static("/", "./static")  // Fallback for old files
```

**That's it!** The WebSocket protocol remains the same.

### Features Preserved

✅ All features work exactly the same:
- Real-time messaging
- Private chats
- Group chats
- Create/join groups
- Online user list
- Notifications

---

## 💡 Important Things to Know

### 1. Two Modes of Development

**Development Mode:**
- Use when writing code
- Hot reload enabled (instant updates)
- Frontend: `http://localhost:3000`
- Backend: `http://localhost:8080`
- No need to rebuild after every change!

**Production Mode:**
- Use for deployment
- Optimized and minified code
- Everything served from: `http://localhost:8080`
- Need to rebuild when code changes

### 2. The `dist/` Folder

**What is it?**
- Generated by `npm run build`
- Contains optimized React app files
- Ready for production deployment


### 3. Hot Reload (Development Mode)

**How it works:**
```
1. Edit file in src/ folder
2. Save (Ctrl + S)
3. Vite detects change
4. Browser updates automatically
5. No manual refresh needed! ⚡
```

### 8. Build Process

**What happens when you run `npm run build`:**

```
1. TypeScript → JavaScript
   (Remove types, compile to JS)

2. Bundle files
   (Combine all files into one)

3. Minify code
   (Remove spaces, shorten names)

4. Optimize
   (Remove unused code, compress)

5. Generate dist/ folder
   (Ready for production!)
```

---

## 📎 File Upload Feature

### Overview

GoTalkie now supports uploading and sharing C/C++ source code files with **syntax highlighting** in both private and group chats!

### Supported File Types

| Extension | Type | Max Size |
|-----------|------|----------|
| .c | C Source | 1MB |
| .cpp, .cc, .cxx | C++ Source | 1MB |
| .h | C/C++ Header | 1MB |
| .hpp | C++ Header | 1MB |


- **Interactive Preview** - View code before sending

- **Line Numbers** - Easy code reference

- **File Info Display** - Name, size, type, line count

- **Group Support** - Share files in group chats


**Code Preview Modal:**
```
┌─────────────────────────────────────┐
│ example.c                      [×]  │
├─────────────────────────────────────┤
│ C | 2.5 KB | 45 lines               │
├───┬─────────────────────────────────┤
│ 1 │ #include <stdio.h>              │
│ 2 │ int main() {                    │
│ 3 │     printf("Hello!\n");         │
│ 4 │     return 0;                   │
│ 5 │ }                               │
├───┴─────────────────────────────────┤
│              [Close]  [Send File]   │
└─────────────────────────────────────┘
```

---





